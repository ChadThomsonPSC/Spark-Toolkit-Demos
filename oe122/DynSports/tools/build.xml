<project name="ABLWebApp" basedir="." default="status">

    <macrodef name="init_env">
        <sequential>
            <property environment="env"/>

            <!-- Check if DLC is set as an environment variable. -->
            <fail message="$DLC path is not set">
                <condition>
                    <and>
                        <not><isset property="dlcHome"/></not>
                        <not><isset property="env.DLC"/></not>
                    </and>
                </condition>
            </fail>
            <property name="dlcHome" value="${env.DLC}"/>
            <echo message="DLC Home: ${dlcHome}"/>

            <property name="scheme" value="http"/>
            <property name="host" value="localhost"/>
            <property name="port" value="8820"/>
            <property name="userid" value="tomcat"/>
            <property name="passwd" value="tomcat"/>
            <property name="ablapp" value="SportsPASOE"/>
        </sequential>
    </macrodef>

    <target name="status">
        <init_env/>

        <taskdef resource="PCT.properties" classpath="${dlcHome}/pct/PCT.jar"/>
        <PCTVersion/>

        <PCTRun
               dlcHome="${dlcHome}"
               graphicalMode="false"
               procedure="getStatus.p">
            <propath>
                <pathelement path="${dlcHome}/tty/netlib/OpenEdge.Net.pl"/>
            </propath>
        	<Parameter name="Scheme" value="${scheme}"/>
        	<Parameter name="Host" value="${host}"/>
    		<Parameter name="Port" value="${port}"/>
    		<Parameter name="UserID" value="${userid}"/>
    		<Parameter name="PassWD" value="${passwd}"/>
        	<Parameter name="ABLApp" value="${ablapp}"/>
        </PCTRun>
    </target>

    <target name="trim">
        <init_env/>

        <taskdef resource="PCT.properties" classpath="${dlcHome}/pct/PCT.jar"/>
        <PCTVersion/>

        <PCTRun
               dlcHome="${dlcHome}"
               graphicalMode="false"
               procedure="trimSessions.p">
            <propath>
                <pathelement path="${dlcHome}/tty/netlib/OpenEdge.Net.pl"/>
            </propath>
            <Parameter name="Scheme" value="${scheme}"/>
            <Parameter name="Host" value="${host}"/>
            <Parameter name="Port" value="${port}"/>
            <Parameter name="UserID" value="${userid}"/>
            <Parameter name="PassWD" value="${passwd}"/>
            <Parameter name="ABLApp" value="${ablapp}"/>
        </PCTRun>
    </target>

</project>