<project name="ABLWebApp" basedir="." default="status">

    <macrodef name="init_env">
        <sequential>
            <property environment="env"/>

            <!-- Check if DLC is set as an environment variable. -->
            <fail message="$DLC path is not set">
                <condition>
                    <and>
                        <not><isset property="dlcHome"/></not>
                        <not><isset property="env.DLC"/></not>
                    </and>
                </condition>
            </fail>
            <property name="dlcHome" value="${env.DLC}"/>
            <echo message="DLC Home: ${dlcHome}"/>

            <!-- Determine current operating system in use. -->
            <echo message="OS Arch: ${os.arch}"/>
            <condition property="isWin64">
                <os family="windows"/>
            </condition>
            <condition property="isUnix">
                <os family="unix"/>
            </condition>

            <!-- Determine script suffix, database location, and PAS root. -->
            <condition property="scriptSuffix" value="sh" else="bat">
                <os family="unix"/>
            </condition>
            <condition property="path" value="/usr/databases" else="C:\Databases">
                <os family="unix"/>
            </condition>
            <condition property="pas.root" value="/usr/pas" else="C:/PASOE">
                <os family="unix"/>
            </condition>

            <!-- Add the ANT-Contrib library to this environment (present in 11.7.4+ and 12.0+). -->
            <taskdef resource="net/sf/antcontrib/antcontrib.properties" classpath="${dlcHome}/ant/lib/ant-contrib-0.6.jar"/>
        </sequential>
    </macrodef>

    <target name="status">
        <init_env/>

        <taskdef resource="PCT.properties" classpath="${dlcHome}/pct/PCT.jar"/>
        <PCTVersion/>

        <PCTRun
               dlcHome="${dlcHome}"
               graphicalMode="false"
               procedure="getStatus.p">
            <propath>
                <pathelement path="${dlcHome}/tty/netlib/OpenEdge.Net.pl"/>
            </propath>
        </PCTRun>
    </target>

</project>